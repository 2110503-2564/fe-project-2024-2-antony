{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Gun/Desktop/FE/fe-project-2024-2-antony/src/components/ReservationItem.tsx"],"sourcesContent":["import { ReserveItem } from \"../../interface\";\r\n\r\n\r\nexport default function ReservationItem({ reserve, onEdit, onDelete, isAdmin}: { reserve: ReserveItem, onEdit: () => void, onDelete: () => void, isAdmin: Boolean }) {\r\n    return (\r\n        <div className=\"flex items-center justify-between p-4 bg-gray-100 rounded-lg shadow-sm\">\r\n            <div>\r\n                <h2 className=\"text-lg font-semibold\">{reserve.massageShop.name}</h2>\r\n                {isAdmin && <p className=\"text-gray-500\">Reserver ID: {reserve.user}</p>}\r\n                <p className=\"text-gray-500\">\r\n                    {new Date(reserve.reserveDate).toLocaleDateString(\"en-GB\", {\r\n                        year: \"numeric\",\r\n                        month: \"long\",\r\n                        day: \"numeric\",\r\n                    })}\r\n                </p>\r\n            </div>\r\n            <div className=\"flex space-x-2 md:flex-row flex-col space-y-2 md:space-y-0\">\r\n                <button className=\"bg-gray-800 hover:bg-gray-700 hover:cursor-pointer text-white px-4 py-2 rounded-lg w-20\" onClick={onEdit}>Edit</button>\r\n                <button className=\"bg-red-600 hover:bg-red-500 hover:cursor-pointer text-white px-4 py-2 rounded-lg w-20\" onClick={onDelete}>Delete</button>\r\n            </div>\r\n        </div>\r\n    );\r\n}"],"names":[],"mappings":";;;;;AAGe,SAAS,gBAAgB,EAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,OAAO,EAAuF;IAC/J,qBACI,8OAAC;QAAI,WAAU;;0BACX,8OAAC;;kCACG,8OAAC;wBAAG,WAAU;kCAAyB,QAAQ,WAAW,CAAC,IAAI;;;;;;oBAC9D,yBAAW,8OAAC;wBAAE,WAAU;;4BAAgB;4BAAc,QAAQ,IAAI;;;;;;;kCACnE,8OAAC;wBAAE,WAAU;kCACR,IAAI,KAAK,QAAQ,WAAW,EAAE,kBAAkB,CAAC,SAAS;4BACvD,MAAM;4BACN,OAAO;4BACP,KAAK;wBACT;;;;;;;;;;;;0BAGR,8OAAC;gBAAI,WAAU;;kCACX,8OAAC;wBAAO,WAAU;wBAA0F,SAAS;kCAAQ;;;;;;kCAC7H,8OAAC;wBAAO,WAAU;wBAAwF,SAAS;kCAAU;;;;;;;;;;;;;;;;;;AAI7I","debugId":null}},
    {"offset": {"line": 95, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Gun/Desktop/FE/fe-project-2024-2-antony/src/libs/getReservations.tsx"],"sourcesContent":["export default async function getReservations() {\r\n    try {\r\n        const token = localStorage.getItem(\"token\");\r\n        if (!token) {\r\n            throw new Error(\"No token found\");\r\n        }\r\n        \r\n        const response = await fetch(\"https://antony-massage-backend-production.up.railway.app/api/v1/reservations\", {\r\n            headers: {\r\n                Authorization: `Bearer ${token}`\r\n            }\r\n        });\r\n\r\n        const data = await response.json();\r\n\r\n        if (!response.ok) {\r\n            throw new Error(`Failed to fetch reservations: ${data.message || \"Unknown error\"}`);\r\n        }\r\n\r\n        return data.data;\r\n    } catch (error) {\r\n        console.error(\"Error during fetching reservations:\", error);\r\n    }\r\n}"],"names":[],"mappings":";;;AAAe,eAAe;IAC1B,IAAI;QACA,MAAM,QAAQ,aAAa,OAAO,CAAC;QACnC,IAAI,CAAC,OAAO;YACR,MAAM,IAAI,MAAM;QACpB;QAEA,MAAM,WAAW,MAAM,MAAM,gFAAgF;YACzG,SAAS;gBACL,eAAe,CAAC,OAAO,EAAE,OAAO;YACpC;QACJ;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAEhC,IAAI,CAAC,SAAS,EAAE,EAAE;YACd,MAAM,IAAI,MAAM,CAAC,8BAA8B,EAAE,KAAK,OAAO,IAAI,iBAAiB;QACtF;QAEA,OAAO,KAAK,IAAI;IACpB,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,uCAAuC;IACzD;AACJ","debugId":null}},
    {"offset": {"line": 124, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Gun/Desktop/FE/fe-project-2024-2-antony/src/libs/deleteReservation.tsx"],"sourcesContent":["export default async function deleteReservation(reservationId: string, token: string) {\r\n    try {\r\n      if (!token) {\r\n        alert(\"You need to be logged in to delete a reservation.\");\r\n        return;\r\n      }\r\n\r\n      const response = await fetch(\r\n        `https://antony-massage-backend-production.up.railway.app/api/v1/reservations/${reservationId}`,\r\n        {\r\n          method: \"DELETE\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n        }\r\n      );\r\n  \r\n      const resText = await response.text();\r\n      if (!response.ok) {\r\n        console.error(\"API Error:\", resText);\r\n        throw new Error(\"Delete reservation failed\");\r\n      }\r\n  \r\n      return JSON.parse(resText);\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  }\r\n  "],"names":[],"mappings":";;;AAAe,eAAe,kBAAkB,aAAqB,EAAE,KAAa;IAChF,IAAI;QACF,IAAI,CAAC,OAAO;YACV,MAAM;YACN;QACF;QAEA,MAAM,WAAW,MAAM,MACrB,CAAC,6EAA6E,EAAE,eAAe,EAC/F;YACE,QAAQ;YACR,SAAS;gBACP,gBAAgB;gBAChB,eAAe,CAAC,OAAO,EAAE,OAAO;YAClC;QACF;QAGF,MAAM,UAAU,MAAM,SAAS,IAAI;QACnC,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,QAAQ,KAAK,CAAC,cAAc;YAC5B,MAAM,IAAI,MAAM;QAClB;QAEA,OAAO,KAAK,KAAK,CAAC;IACpB,EAAE,OAAO,OAAO;QACd,MAAM;IACR;AACF","debugId":null}},
    {"offset": {"line": 156, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Gun/Desktop/FE/fe-project-2024-2-antony/src/components/DateReserve.tsx"],"sourcesContent":["\"use client\";\r\nimport { DatePicker } from \"@mui/x-date-pickers\";\r\nimport { LocalizationProvider } from \"@mui/x-date-pickers\";\r\nimport { AdapterDayjs } from \"@mui/x-date-pickers/AdapterDayjs\";\r\nimport dayjs from \"dayjs\";\r\n\r\nexport default function DateReserve({\r\n  selectedDate,\r\n  setSelectedDate,\r\n}: {\r\n  selectedDate: dayjs.Dayjs | null;\r\n  setSelectedDate: (date: dayjs.Dayjs | null) => void;\r\n}) {\r\n  return (\r\n    // <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n    //   <div className=\"w-full\">\r\n    //     <DatePicker\r\n    //       className=\"w-full bg-white\"\r\n    //       value={selectedDate}\r\n    //       onChange={(newValue) => setSelectedDate(newValue)}\r\n    //     />\r\n    //   </div>\r\n    // </LocalizationProvider>\r\n    <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n      <div className=\"w-full\">\r\n        <DatePicker\r\n          className=\"w-full bg-gray-100\"\r\n          value={selectedDate}\r\n          onChange={(newValue) => setSelectedDate(newValue)}\r\n          slotProps={{\r\n            textField: {\r\n              sx: {\r\n                width: \"100%\",\r\n                backgroundColor: \"#F3F4F6\", // Tailwind bg-gray-100\r\n                borderRadius: \"8px\", // Tailwind rounded-lg\r\n                color: \"#374151\", // Tailwind text-gray-700\r\n                \"& .MuiOutlinedInput-root\": {\r\n                  \"& fieldset\": { border: \"none\" }, // Remove border\r\n                },\r\n                \"& .MuiInputBase-input\": {\r\n                  color: \"#374151\", // Tailwind text-gray-700\r\n                  fontSize: \"16px\",\r\n                  height: \"10px\", // Set input height\r\n                },\r\n                \"& .MuiSvgIcon-root\": {\r\n                  color: \"#374151\", // Tailwind text-gray-700 for the calendar icon\r\n                },\r\n              },\r\n            },\r\n          }}\r\n        />\r\n      </div>\r\n    </LocalizationProvider>\r\n\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AAHA;;;;;AAMe,SAAS,YAAY,EAClC,YAAY,EACZ,eAAe,EAIhB;IACC,OACE,oDAAoD;IACpD,6BAA6B;IAC7B,kBAAkB;IAClB,oCAAoC;IACpC,6BAA6B;IAC7B,2DAA2D;IAC3D,SAAS;IACT,WAAW;IACX,0BAA0B;kBAC1B,8OAAC,6LAAA,CAAA,uBAAoB;QAAC,aAAa,6KAAA,CAAA,eAAY;kBAC7C,cAAA,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC,yKAAA,CAAA,aAAU;gBACT,WAAU;gBACV,OAAO;gBACP,UAAU,CAAC,WAAa,gBAAgB;gBACxC,WAAW;oBACT,WAAW;wBACT,IAAI;4BACF,OAAO;4BACP,iBAAiB;4BACjB,cAAc;4BACd,OAAO;4BACP,4BAA4B;gCAC1B,cAAc;oCAAE,QAAQ;gCAAO;4BACjC;4BACA,yBAAyB;gCACvB,OAAO;gCACP,UAAU;gCACV,QAAQ;4BACV;4BACA,sBAAsB;gCACpB,OAAO;4BACT;wBACF;oBACF;gBACF;;;;;;;;;;;;;;;;AAMV","debugId":null}},
    {"offset": {"line": 231, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Gun/Desktop/FE/fe-project-2024-2-antony/src/libs/getShops.tsx"],"sourcesContent":["import { MassageJson } from \"../../interface\";\r\n\r\nconst getShops = async (): Promise<MassageJson> => {\r\n  const response = await fetch(\"https://antony-massage-backend-production.up.railway.app/api/v1/massage-shops\");\r\n  if (!response.ok) {\r\n    throw Error(\"Failed to fetch shops\");\r\n  }\r\n  const jsonfile = await response.json();\r\n  return jsonfile;\r\n};\r\n\r\nexport default getShops;\r\n"],"names":[],"mappings":";;;AAEA,MAAM,WAAW;IACf,MAAM,WAAW,MAAM,MAAM;IAC7B,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,MAAM;IACd;IACA,MAAM,WAAW,MAAM,SAAS,IAAI;IACpC,OAAO;AACT;uCAEe","debugId":null}},
    {"offset": {"line": 249, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Gun/Desktop/FE/fe-project-2024-2-antony/src/components/EditReservation.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport DateReserve from \"@/components/DateReserve\";\r\nimport getShops from \"@/libs/getShops\";\r\nimport { MassageItem } from \"../../interface\";\r\nimport { Dayjs } from \"dayjs\";\r\n\r\nexport default function EditReservation({\r\n  reservationId,\r\n  reservationShopId,\r\n  reservationDate,\r\n  onClose,\r\n  onUpdate,\r\n}: {\r\n  reservationId: string,\r\n  reservationShopId: string,\r\n  reservationDate: Dayjs,\r\n  onClose: () => void,\r\n  onUpdate: (reservationId: string, updatedData: any) => void,\r\n}) {\r\n  const [shops, setShops] = useState<MassageItem[]>([]);\r\n  const [selectedShop, setSelectedShop] = useState(reservationShopId);\r\n  const [selectedDate, setSelectedDate] = useState<Dayjs | null>(reservationDate);\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"token\");\r\n    if (!token) {\r\n      router.push(\"/login\");\r\n      return;\r\n    }\r\n\r\n    const fetchShops = async () => {\r\n      try {\r\n        const data = await getShops();\r\n        setShops(data.data);\r\n      } catch (error) {\r\n        console.error(\"Failed to fetch shops:\", error);\r\n      }\r\n    };\r\n\r\n    fetchShops();\r\n  }, [router]);\r\n\r\n  const handleUpdate = () => {\r\n    if (!selectedShop || !selectedDate) {\r\n      alert(\"Please select a shop and a date.\");\r\n      return;\r\n    }\r\n\r\n    console.log(\"Before update - Shop ID:\", selectedShop, \"Date:\", selectedDate);\r\n\r\n    onUpdate(reservationId, {\r\n      massageShopId: selectedShop,\r\n      reserveDate: selectedDate.format(\"YYYY-MM-DD\"),\r\n    });\r\n\r\n    console.log(\"Updated data passed to onUpdate:\", {\r\n      massageShopId: selectedShop,\r\n      reserveDate: selectedDate.format(\"YYYY-MM-DD\"),\r\n    });\r\n\r\n    onClose();\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-white shadow-lg rounded-lg p-8 w-full md:max-w-xl max-w-xs\">\r\n      <div className=\"mb-4 w-full\">\r\n        <label className=\"block text-lg font-semibold mb-2 w-full\">\r\n          Date Reservation\r\n        </label>\r\n        <DateReserve selectedDate={selectedDate} setSelectedDate={setSelectedDate} />\r\n      </div>\r\n\r\n      <div className=\"mb-6\">\r\n        <label className=\"block text-lg font-semibold mb-2\">Massage Shop</label>\r\n        <select\r\n          className=\"w-full rounded-lg p-3 bg-gray-100 text-gray-700 hover:cursor-pointer\"\r\n          value={selectedShop}\r\n          onChange={(e) => setSelectedShop(e.target.value)}\r\n        >\r\n          <option value=\"\" disabled>Select Massage Shop</option>\r\n          {shops.map((shop) => (\r\n            <option key={shop._id} value={shop._id}>\r\n              {shop.name}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      <div className=\"flex gap-4\">\r\n        <button\r\n          onClick={onClose}\r\n          className=\"w-full bg-gray-800 text-white py-3 rounded-lg font-semibold text-lg hover:bg-gray-700 hover:cursor-pointer transition\"\r\n        >\r\n          Cancel\r\n        </button>\r\n        <button\r\n          onClick={handleUpdate}\r\n          className=\"w-full bg-green-600 text-white py-3 rounded-lg font-semibold text-lg hover:bg-green-500 hover:cursor-pointer transition\"\r\n        >\r\n          Update\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AASe,SAAS,gBAAgB,EACtC,aAAa,EACb,iBAAiB,EACjB,eAAe,EACf,OAAO,EACP,QAAQ,EAOT;IACC,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAiB,EAAE;IACpD,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACjD,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAgB;IAC/D,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IAEvB,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,QAAQ,aAAa,OAAO,CAAC;QACnC,IAAI,CAAC,OAAO;YACV,OAAO,IAAI,CAAC;YACZ;QACF;QAEA,MAAM,aAAa;YACjB,IAAI;gBACF,MAAM,OAAO,MAAM,CAAA,GAAA,wHAAA,CAAA,UAAQ,AAAD;gBAC1B,SAAS,KAAK,IAAI;YACpB,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,0BAA0B;YAC1C;QACF;QAEA;IACF,GAAG;QAAC;KAAO;IAEX,MAAM,eAAe;QACnB,IAAI,CAAC,gBAAgB,CAAC,cAAc;YAClC,MAAM;YACN;QACF;QAEA,QAAQ,GAAG,CAAC,4BAA4B,cAAc,SAAS;QAE/D,SAAS,eAAe;YACtB,eAAe;YACf,aAAa,aAAa,MAAM,CAAC;QACnC;QAEA,QAAQ,GAAG,CAAC,oCAAoC;YAC9C,eAAe;YACf,aAAa,aAAa,MAAM,CAAC;QACnC;QAEA;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAM,WAAU;kCAA0C;;;;;;kCAG3D,8OAAC,iIAAA,CAAA,UAAW;wBAAC,cAAc;wBAAc,iBAAiB;;;;;;;;;;;;0BAG5D,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAM,WAAU;kCAAmC;;;;;;kCACpD,8OAAC;wBACC,WAAU;wBACV,OAAO;wBACP,UAAU,CAAC,IAAM,gBAAgB,EAAE,MAAM,CAAC,KAAK;;0CAE/C,8OAAC;gCAAO,OAAM;gCAAG,QAAQ;0CAAC;;;;;;4BACzB,MAAM,GAAG,CAAC,CAAC,qBACV,8OAAC;oCAAsB,OAAO,KAAK,GAAG;8CACnC,KAAK,IAAI;mCADC,KAAK,GAAG;;;;;;;;;;;;;;;;;0BAO3B,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,SAAS;wBACT,WAAU;kCACX;;;;;;kCAGD,8OAAC;wBACC,SAAS;wBACT,WAAU;kCACX;;;;;;;;;;;;;;;;;;AAMT","debugId":null}},
    {"offset": {"line": 415, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Gun/Desktop/FE/fe-project-2024-2-antony/src/libs/updateReservation.tsx"],"sourcesContent":["export interface UpdateReservationPayload {\r\n    reservationId: string;\r\n    massageShopId: string;\r\n    reserveDate: string;\r\n    token: string;\r\n  }\r\n  \r\n  export default async function updateReservation({\r\n    reservationId,\r\n    massageShopId,\r\n    reserveDate,\r\n    token,\r\n  }: UpdateReservationPayload) {\r\n    // console.log(\"updateReservationss\", reservationId, massageShopId, reserveDate, token);\r\n    try {\r\n      const response = await fetch(\r\n        `https://antony-massage-backend-production.up.railway.app/api/v1/reservations/${reservationId}`,\r\n        {\r\n          method: \"PUT\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n          // body: JSON.stringify({ test, reserveDate }),\r\n          body: JSON.stringify({\r\n            reserveDate: reserveDate,\r\n            massageShop: massageShopId\r\n        }),\r\n        }\r\n      );\r\n  \r\n      const resText = await response.text();\r\n      if (!response.ok) {\r\n        console.error(\"API Error:\", resText);\r\n        throw new Error(\"Update reservation failed\");\r\n      }\r\n  \r\n      return JSON.parse(resText);\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  }"],"names":[],"mappings":";;;AAOiB,eAAe,kBAAkB,EAC9C,aAAa,EACb,aAAa,EACb,WAAW,EACX,KAAK,EACoB;IACzB,wFAAwF;IACxF,IAAI;QACF,MAAM,WAAW,MAAM,MACrB,CAAC,6EAA6E,EAAE,eAAe,EAC/F;YACE,QAAQ;YACR,SAAS;gBACP,gBAAgB;gBAChB,eAAe,CAAC,OAAO,EAAE,OAAO;YAClC;YACA,+CAA+C;YAC/C,MAAM,KAAK,SAAS,CAAC;gBACnB,aAAa;gBACb,aAAa;YACjB;QACA;QAGF,MAAM,UAAU,MAAM,SAAS,IAAI;QACnC,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,QAAQ,KAAK,CAAC,cAAc;YAC5B,MAAM,IAAI,MAAM;QAClB;QAEA,OAAO,KAAK,KAAK,CAAC;IACpB,EAAE,OAAO,OAAO;QACd,MAAM;IACR;AACF","debugId":null}},
    {"offset": {"line": 449, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Gun/Desktop/FE/fe-project-2024-2-antony/src/components/ConfirmPopup.tsx"],"sourcesContent":["export default function ConfirmPopup({ onClose, onDelete, title }: { onClose: () => void, onDelete: () => void, title: string }){\r\n    return (\r\n    <div className=\"bg-white shadow-lg rounded-lg p-8 w-full md:max-w-xl max-w-xs\">\r\n        <div className=\"mb-4 w-full\">\r\n            <label className=\"block text-lg font-semibold mb-2 w-full text-center\">\r\n            {title}\r\n            </label>\r\n        </div>\r\n\r\n        <div className=\"flex gap-4\">\r\n        <button\r\n            onClick={onClose}\r\n            className=\"w-full bg-gray-800 text-white py-3 rounded-lg font-semibold text-lg hover:bg-gray-700 hover:cursor-pointer transition\"\r\n        >\r\n            Cancel\r\n        </button>\r\n        <button\r\n            onClick={onDelete}\r\n            className=\"w-full bg-red-600 text-white py-3 rounded-lg font-semibold text-lg hover:bg-red-500 hover:cursor-pointer transition\"\r\n        >\r\n            Delete\r\n        </button>\r\n        </div>\r\n    </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAe,SAAS,aAAa,EAAE,OAAO,EAAE,QAAQ,EAAE,KAAK,EAAgE;IAC3H,qBACA,8OAAC;QAAI,WAAU;;0BACX,8OAAC;gBAAI,WAAU;0BACX,cAAA,8OAAC;oBAAM,WAAU;8BAChB;;;;;;;;;;;0BAIL,8OAAC;gBAAI,WAAU;;kCACf,8OAAC;wBACG,SAAS;wBACT,WAAU;kCACb;;;;;;kCAGD,8OAAC;wBACG,SAAS;wBACT,WAAU;kCACb;;;;;;;;;;;;;;;;;;AAMT","debugId":null}},
    {"offset": {"line": 513, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Gun/Desktop/FE/fe-project-2024-2-antony/src/app/%28page%29/myreservation/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport ReservationItem from \"@/components/ReservationItem\";\r\nimport { ReserveItem } from \"../../../../interface\";\r\nimport getReservations from \"@/libs/getReservations\";\r\nimport deleteReservation from \"@/libs/deleteReservation\";\r\nimport EditReservation from \"@/components/EditReservation\";\r\nimport updateReservation from \"@/libs/updateReservation\";\r\nimport dayjs, { Dayjs } from \"dayjs\";\r\nimport CircularProgress from \"@mui/material/CircularProgress\";\r\nimport ConfirmPopup from \"@/components/ConfirmPopup\";\r\n\r\nexport default function ReservationPage() {\r\n  const [reservations, setReservations] = useState<ReserveItem[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(\"\");\r\n  const [editingReservationId, setEditingReservationId] = useState<string | null>(null);\r\n  const [editingReservationShopId, setEditingReservationShopId] = useState<string | null>(null);\r\n  const [editingReservationDate, setEditingReservationDate] = useState<Dayjs | null>(null);\r\n  const [isAdmin, setIsAdmin] = useState<Boolean>(false);\r\n  const [deletePopup, setDeletePopup] = useState(false);\r\n  const [deletingReservationId, setDeletingReservationId] = useState<string | null>(null);\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    try {\r\n      const userData = localStorage.getItem(\"user\");\r\n      if (userData) {\r\n        const user = JSON.parse(userData);\r\n        if (user.role === \"admin\") {\r\n          setIsAdmin(true);\r\n        } else {\r\n          setIsAdmin(false);\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Failed to parse user data\", err);\r\n      localStorage.removeItem(\"user\");\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      const token = localStorage.getItem(\"token\");\r\n\r\n      if (!token) {\r\n        router.push(\"/login\");\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const data = await getReservations();\r\n        setReservations(data || []);\r\n      } catch (err: any) {\r\n        setError(err.message || \"Failed to load reservations\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, [router]);\r\n\r\n  const handleEdit = (reservationId: string, reservationShopId: string, reservationDate: string) => {\r\n    setEditingReservationId(reservationId);\r\n    setEditingReservationShopId(reservationShopId);\r\n    setEditingReservationDate(dayjs(reservationDate));\r\n  };\r\n\r\n  const handleDeleteClick = (reservationId: string) => {\r\n    setDeletePopup(true);\r\n    setDeletingReservationId(reservationId);\r\n  };\r\n\r\n  const handleDelete = async () => {\r\n    if(deletingReservationId != null){\r\n      try {\r\n        const token = localStorage.getItem(\"token\");\r\n        await deleteReservation(deletingReservationId, token || \"\");\r\n        \r\n        setDeletePopup(false);\r\n        setDeletingReservationId(null);\r\n        const data = await getReservations();\r\n        alert(\"Delete Reservation successful!\");\r\n        setReservations(data || []);\r\n      } catch (error) {\r\n        console.error(\"Error deleting reservation:\", error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleUpdate = async (reservationId: string, updatedData: any) => {\r\n    try {\r\n      const token = localStorage.getItem(\"token\");\r\n      await updateReservation({\r\n        reservationId,\r\n        ...updatedData,\r\n        token: token || \"\",\r\n      });\r\n      const data = await getReservations();\r\n      alert(\"Update Reservation successful!\");\r\n      setReservations(data || []);\r\n      setEditingReservationId(null);\r\n    } catch (error) {\r\n      console.error(\"Error updating reservation:\", error);\r\n    }\r\n  };\r\n\r\n  const handleCloseEdit = () => {\r\n    setEditingReservationId(null);\r\n    setEditingReservationShopId(null);\r\n    setEditingReservationDate(null);\r\n  };\r\n\r\n  const handleCloseDelete = () => {\r\n    setDeletePopup(false);\r\n    setDeletingReservationId(null);\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex flex-col items-center justify-center h-screen space-y-4\">\r\n        <CircularProgress sx={{ color: \"rgb(220, 38, 38)\" }} size={60} thickness={5} />\r\n        <p className=\"text-lg font-semibold text-gray-600\">Loading...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex flex-col items-center p-10 w-full pt-20 md:pt-10\">\r\n      <div className=\"w-full max-w-4xl space-y-4 mt-15\">\r\n      {reservations.length > 0 ? (\r\n        reservations.map((reservation) => (\r\n          <ReservationItem\r\n            key={reservation._id}\r\n            reserve={reservation}\r\n            onEdit={() =>\r\n              handleEdit(\r\n                reservation._id,\r\n                reservation.massageShop._id,\r\n                reservation.reserveDate\r\n              )\r\n            }\r\n            onDelete={() => handleDeleteClick(reservation._id)}\r\n            isAdmin={isAdmin}\r\n          />\r\n        ))\r\n      ) : (\r\n        <p className=\"text-center text-gray-600 text-lg\">{!isAdmin ? \"You don't have any reservations.\" : \"Don't have any reservations.\"}</p>\r\n      )}\r\n      </div>\r\n\r\n      {editingReservationId && editingReservationShopId && editingReservationDate && (\r\n        <div className=\"fixed inset-0 flex items-center justify-center bg-[rgba(0,0,0,0.5)]\">\r\n          <EditReservation\r\n            reservationId={editingReservationId}\r\n            reservationShopId={editingReservationShopId}\r\n            reservationDate={editingReservationDate}\r\n            onClose={handleCloseEdit}\r\n            onUpdate={handleUpdate}\r\n          />\r\n        </div>\r\n      )}\r\n\r\n      {deletePopup && (\r\n        <div className=\"fixed inset-0 flex items-center justify-center bg-[rgba(0,0,0,0.5)]\">\r\n          <ConfirmPopup onClose={handleCloseDelete} onDelete={handleDelete} title={\"Are you sure you want to delete this reservation?\"}/>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}