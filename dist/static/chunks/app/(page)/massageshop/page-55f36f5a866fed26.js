(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[837],{6510:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var l=s(5155);function a(e){let{onClose:t,onDelete:s,title:a}=e;return(0,l.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-8 w-full md:max-w-xl max-w-xs",children:[(0,l.jsx)("div",{className:"mb-4 w-full",children:(0,l.jsx)("label",{className:"block text-lg font-semibold mb-2 w-full text-center",children:a})}),(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsx)("button",{onClick:t,className:"w-full bg-gray-800 text-white py-3 rounded-lg font-semibold text-lg hover:bg-gray-700 hover:cursor-pointer transition",children:"Cancel"}),(0,l.jsx)("button",{onClick:s,className:"w-full bg-red-600 text-white py-3 rounded-lg font-semibold text-lg hover:bg-red-500 hover:cursor-pointer transition",children:"Delete"})]})]})}},6771:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=async()=>{let e=await fetch("https://antony-massage-backend-production.up.railway.app/api/v1/massage-shops");if(!e.ok)throw Error("Failed to fetch shops");return await e.json()}},8692:(e,t,s)=>{Promise.resolve().then(s.bind(s,9497))},9497:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>w});var l=s(5155),a=s(2115),r=s(9915),o=s(6510),n=s(6771),c=s(6874),i=s.n(c);function d(e){let{shop:t,showDeletePopup:s,isAdmin:a}=e;return(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-100 rounded-lg shadow-sm",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-lg font-semibold",children:t.name}),(0,l.jsx)("p",{className:"text-gray-500",children:t.address}),(0,l.jsxs)("p",{className:"text-gray-500",children:["Tel: ",t.tel]}),(0,l.jsxs)("p",{className:"text-gray-500",children:["Open: ",t.openTime," - ",t.closeTime]})]}),a?(0,l.jsx)("button",{onClick:()=>s(t._id),className:"bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded-lg hover:cursor-pointer transition",children:"Delete"}):(0,l.jsx)(i(),{href:"/reservation?shopId=".concat(t._id),children:(0,l.jsx)("button",{className:"bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded-lg hover:cursor-pointer transition",children:"Reserve"})})]})}async function h(e,t){try{let s=await fetch("https://antony-massage-backend-production.up.railway.app/api/v1/massage-shops/".concat(t),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!s.ok)throw Error("Error: ".concat(s.status," - ").concat(s.statusText));console.log("Shop deleted successfully")}catch(e){console.error("Failed to delete shop:",e)}}var u=s(5695),m=s(832),x=s.n(m),p=s(5571),g=s(9952),f=s(5353);function b(e){let{selectedDate:t,setSelectedDate:s}=e;return(0,l.jsx)(p.$,{dateAdapter:g.R,children:(0,l.jsx)("div",{className:"w-full",children:(0,l.jsx)(f.A,{label:"",value:t,onChange:e=>s(e),slotProps:{textField:{sx:{width:"100%",backgroundColor:"#F3F4F6",borderRadius:"8px",color:"#374151","& .MuiOutlinedInput-root":{"& fieldset":{border:"none"}},"& .MuiInputBase-input":{color:"#374151",fontSize:"16px",height:"10px"},"& .MuiSvgIcon-root":{color:"#374151"}}}}})})})}function y(e){let{onClose:t,onCreate:s}=e,r=(0,u.useRouter)(),[o,n]=(0,a.useState)(""),[c,i]=(0,a.useState)(""),[d,h]=(0,a.useState)(""),[m,p]=(0,a.useState)(x()()),[g,f]=(0,a.useState)(x()());return(0,a.useEffect)(()=>{if(!localStorage.getItem("token")){r.push("/login");return}},[r]),(0,l.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-8 w-full md:max-w-xl max-w-xs",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4 text-center",children:"Add massage shop"}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-lg font-semibold mb-2",children:"Name"}),(0,l.jsx)("input",{type:"text",className:"w-full rounded-lg p-3 bg-gray-100 text-gray-700",value:o,placeholder:"Enter shop name",onChange:e=>n(e.target.value)})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-lg font-semibold mb-2",children:"Address"}),(0,l.jsx)("input",{type:"text",className:"w-full rounded-lg p-3 bg-gray-100 text-gray-700",value:c,placeholder:"Enter shop Address",onChange:e=>i(e.target.value)})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-lg font-semibold mb-2",children:"Telephone"}),(0,l.jsx)("input",{type:"text",className:"w-full rounded-lg p-3 bg-gray-100 text-gray-700",value:d,placeholder:"Enter shop telephone number",onChange:e=>h(e.target.value)})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-lg font-semibold mb-2",children:"Open time"}),(0,l.jsx)(b,{selectedDate:m,setSelectedDate:p})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-lg font-semibold mb-2",children:"Close time"}),(0,l.jsx)(b,{selectedDate:g,setSelectedDate:f})]}),(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsx)("button",{onClick:t,className:"w-full bg-gray-800 text-white py-3 rounded-lg font-semibold text-lg hover:bg-gray-700 hover:cursor-pointer transition",children:"Cancel"}),(0,l.jsx)("button",{onClick:()=>{if(!o||!c||!d||!m||!g){alert("Please fill in all fields.");return}s(o,c,d,x()(m,"HH:mm").format("hh:mm A"),x()(g,"HH:mm").format("hh:mm A")),n(""),i(""),p(x()()),f(x()()),t()},className:"w-full bg-green-600 text-white py-3 rounded-lg font-semibold text-lg hover:bg-green-500 hover:cursor-pointer transition",children:"Add"})]})]})}async function j(e,t,s,l,a,r){try{let o=await fetch("https://antony-massage-backend-production.up.railway.app/api/v1/massage-shops",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({name:t,address:s,tel:l,openTime:a,closeTime:r})}),n=await o.text();if(!o.ok)throw Error("Error: ".concat(o.status," - ").concat(o.statusText));return console.log("Shop created successfully"),JSON.parse(n)}catch(e){throw console.error("Failed to create shop:",e),e}}function w(){let[e,t]=(0,a.useState)(null),[s,c]=(0,a.useState)(null),[i,u]=(0,a.useState)(!0),[m,x]=(0,a.useState)(!1),[p,g]=(0,a.useState)(!1),[f,b]=(0,a.useState)(!1),w=()=>{try{let e=localStorage.getItem("user");if(e){let t=JSON.parse(e);return"admin"===t.role}}catch(e){console.error("Error parsing user data:",e)}return!1},v=e=>{x(!0),c(e)},N=async()=>{try{let e=await (0,n.A)();t(e)}catch(e){console.error("Error fetching shops:",e)}finally{u(!1)}};(0,a.useEffect)(()=>{b(w),N()},[]);let k=async()=>{if(null!=s)try{let e=localStorage.getItem("token");e&&await h(e,s),x(!1),c(null);let l=await (0,n.A)();t(l),alert("Delete shop successful!")}catch(e){console.error("Error deleting shop:",e)}},S=async(e,t,s,l,a)=>{try{let r=localStorage.getItem("token");r&&await j(r,e,t,s,l,a)&&(alert("Shop added successful!"),g(!1),N())}catch(e){console.error("Error to add shop:",e)}};return i?(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center h-screen space-y-4",children:[(0,l.jsx)(r.A,{sx:{color:"rgb(220, 38, 38)"},size:60,thickness:5}),(0,l.jsx)("p",{className:"text-lg font-semibold text-gray-600",children:"Loading..."})]}):(0,l.jsxs)("div",{className:"flex flex-col items-center p-10 w-full pt-20 md:pt-10",children:[(0,l.jsxs)("div",{className:"w-full max-w-4xl space-y-4 mt-16",children:[(0,l.jsx)("div",{className:"flex flex-row space-x-4",children:f&&(0,l.jsx)("button",{onClick:()=>{g(!0)},className:"w-full bg-gray-800 text-white py-3 rounded-lg font-semibold text-lg hover:bg-gray-700 hover:cursor-pointer transition",children:"Add Massage shop"})}),e?e.data.map(e=>(0,l.jsx)(d,{shop:e,showDeletePopup:e=>{v(e)},isAdmin:f},e._id)):(0,l.jsx)("p",{className:"text-gray-500",children:"Loading shops..."})]}),m&&(0,l.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-[rgba(0,0,0,0.5)]",children:(0,l.jsx)(o.A,{onClose:()=>{x(!1),c(null)},onDelete:k,title:"Are you sure you want to delete this shop?"})}),p&&(0,l.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-[rgba(0,0,0,0.5)]",children:(0,l.jsx)(y,{onClose:()=>{g(!1)},onCreate:S})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[484,874,353,441,684,358],()=>t(8692)),_N_E=e.O()}]);