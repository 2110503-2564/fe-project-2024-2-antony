{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Gun/Desktop/FE/fe-project-2024-2-antony/src/components/DateReserve.tsx"],"sourcesContent":["\"use client\";\r\nimport { DatePicker } from \"@mui/x-date-pickers\";\r\nimport { LocalizationProvider } from \"@mui/x-date-pickers\";\r\nimport { AdapterDayjs } from \"@mui/x-date-pickers/AdapterDayjs\";\r\nimport dayjs from \"dayjs\";\r\n\r\nexport default function DateReserve({\r\n  selectedDate,\r\n  setSelectedDate,\r\n}: {\r\n  selectedDate: dayjs.Dayjs | null;\r\n  setSelectedDate: (date: dayjs.Dayjs | null) => void;\r\n}) {\r\n  return (\r\n    // <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n    //   <div className=\"w-full\">\r\n    //     <DatePicker\r\n    //       className=\"w-full bg-white\"\r\n    //       value={selectedDate}\r\n    //       onChange={(newValue) => setSelectedDate(newValue)}\r\n    //     />\r\n    //   </div>\r\n    // </LocalizationProvider>\r\n    <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n      <div className=\"w-full\">\r\n        <DatePicker\r\n          className=\"w-full bg-gray-100\"\r\n          value={selectedDate}\r\n          onChange={(newValue) => setSelectedDate(newValue)}\r\n          slotProps={{\r\n            textField: {\r\n              sx: {\r\n                width: \"100%\",\r\n                backgroundColor: \"#F3F4F6\", // Tailwind bg-gray-100\r\n                borderRadius: \"8px\", // Tailwind rounded-lg\r\n                color: \"#374151\", // Tailwind text-gray-700\r\n                \"& .MuiOutlinedInput-root\": {\r\n                  \"& fieldset\": { border: \"none\" }, // Remove border\r\n                },\r\n                \"& .MuiInputBase-input\": {\r\n                  color: \"#374151\", // Tailwind text-gray-700\r\n                  fontSize: \"16px\",\r\n                  height: \"10px\", // Set input height\r\n                },\r\n                \"& .MuiSvgIcon-root\": {\r\n                  color: \"#374151\", // Tailwind text-gray-700 for the calendar icon\r\n                },\r\n              },\r\n            },\r\n          }}\r\n        />\r\n      </div>\r\n    </LocalizationProvider>\r\n\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AAHA;;;;;AAMe,SAAS,YAAY,EAClC,YAAY,EACZ,eAAe,EAIhB;IACC,OACE,oDAAoD;IACpD,6BAA6B;IAC7B,kBAAkB;IAClB,oCAAoC;IACpC,6BAA6B;IAC7B,2DAA2D;IAC3D,SAAS;IACT,WAAW;IACX,0BAA0B;kBAC1B,6LAAC,gMAAA,CAAA,uBAAoB;QAAC,aAAa,gLAAA,CAAA,eAAY;kBAC7C,cAAA,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC,4KAAA,CAAA,aAAU;gBACT,WAAU;gBACV,OAAO;gBACP,UAAU,CAAC,WAAa,gBAAgB;gBACxC,WAAW;oBACT,WAAW;wBACT,IAAI;4BACF,OAAO;4BACP,iBAAiB;4BACjB,cAAc;4BACd,OAAO;4BACP,4BAA4B;gCAC1B,cAAc;oCAAE,QAAQ;gCAAO;4BACjC;4BACA,yBAAyB;gCACvB,OAAO;gCACP,UAAU;gCACV,QAAQ;4BACV;4BACA,sBAAsB;gCACpB,OAAO;4BACT;wBACF;oBACF;gBACF;;;;;;;;;;;;;;;;AAMV;KAjDwB","debugId":null}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Gun/Desktop/FE/fe-project-2024-2-antony/src/libs/getShops.tsx"],"sourcesContent":["import { MassageJson } from \"../../interface\";\r\n\r\nconst getShops = async (): Promise<MassageJson> => {\r\n  const response = await fetch(\"https://antony-massage-backend-production.up.railway.app/api/v1/massage-shops\");\r\n  if (!response.ok) {\r\n    throw Error(\"Failed to fetch shops\");\r\n  }\r\n  const jsonfile = await response.json();\r\n  return jsonfile;\r\n};\r\n\r\nexport default getShops;\r\n"],"names":[],"mappings":";;;AAEA,MAAM,WAAW;IACf,MAAM,WAAW,MAAM,MAAM;IAC7B,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,MAAM;IACd;IACA,MAAM,WAAW,MAAM,SAAS,IAAI;IACpC,OAAO;AACT;uCAEe","debugId":null}},
    {"offset": {"line": 109, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Gun/Desktop/FE/fe-project-2024-2-antony/src/libs/createReservation.tsx"],"sourcesContent":["export interface ReservationPayload {\r\n    massageShopId: string;\r\n    reserveDate: string; // ISO string format (e.g., 2025-03-23T14:00:00Z)\r\n    token: string;\r\n  }\r\n  \r\n  export default async function createReservation({\r\n    massageShopId,\r\n    reserveDate,\r\n    token,\r\n  }: ReservationPayload) {\r\n    console.log(\"createReservation\", massageShopId, reserveDate, token);\r\n    try {\r\n      const response = await fetch(`https://antony-massage-backend-production.up.railway.app/api/v1/massage-shops/${massageShopId}/reservations`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          \"Authorization\": `Bearer ${token}`,\r\n        },\r\n        body: JSON.stringify({ reserveDate }),\r\n      });\r\n  \r\n      const resText = await response.text(); // อ่าน raw response\r\n      if (!response.ok) {\r\n        console.error(\"API Error:\", resText); // ✅ Log error จาก API\r\n        // throw new Error(\"Reservation failed\");\r\n        throw new Error(JSON.parse(resText).message);\r\n      }\r\n  \r\n      return JSON.parse(resText); // ถ้า response.ok จริง ค่อย parse เป็น JSON\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n\r\n  "],"names":[],"mappings":";;;AAMiB,eAAe,kBAAkB,EAC9C,aAAa,EACb,WAAW,EACX,KAAK,EACc;IACnB,QAAQ,GAAG,CAAC,qBAAqB,eAAe,aAAa;IAC7D,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,CAAC,8EAA8E,EAAE,cAAc,aAAa,CAAC,EAAE;YAC1I,QAAQ;YACR,SAAS;gBACP,gBAAgB;gBAChB,iBAAiB,CAAC,OAAO,EAAE,OAAO;YACpC;YACA,MAAM,KAAK,SAAS,CAAC;gBAAE;YAAY;QACrC;QAEA,MAAM,UAAU,MAAM,SAAS,IAAI,IAAI,oBAAoB;QAC3D,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,QAAQ,KAAK,CAAC,cAAc,UAAU,sBAAsB;YAC5D,yCAAyC;YACzC,MAAM,IAAI,MAAM,KAAK,KAAK,CAAC,SAAS,OAAO;QAC7C;QAEA,OAAO,KAAK,KAAK,CAAC,UAAU,4CAA4C;IAC1E,EAAE,OAAO,OAAO;QACd,MAAM;IACR;AACF","debugId":null}},
    {"offset": {"line": 145, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Gun/Desktop/FE/fe-project-2024-2-antony/src/app/%28page%29/reservation/page.tsx"],"sourcesContent":["\"use client\";  // Ensures this runs only on the client side\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter, useSearchParams } from \"next/navigation\";\r\nimport DateReserve from \"@/components/DateReserve\";\r\nimport getShops from \"@/libs/getShops\";\r\nimport createReservation from \"@/libs/createReservation\";\r\nimport { MassageItem } from \"../../../../interface\";\r\nimport dayjs, { Dayjs } from \"dayjs\";\r\nimport utc from \"dayjs/plugin/utc\";\r\n\r\ndayjs.extend(utc);\r\n\r\nexport default function Reservation() {\r\n  const [shops, setShops] = useState<MassageItem[]>([]);\r\n  const [selectedShop, setSelectedShop] = useState(\"\");\r\n  const [selectedDate, setSelectedDate] = useState<Dayjs | null>(null);\r\n  const router = useRouter();\r\n  const searchParams = useSearchParams();\r\n  \r\n  useEffect(() => {\r\n    const shopId = searchParams.get(\"shopId\");\r\n    if (shopId) {\r\n      setSelectedShop(shopId);\r\n    }\r\n  }, [searchParams]);  // Add searchParams as a dependency\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"token\");\r\n    if (!token) {\r\n      router.push(\"/login\");\r\n      return;\r\n    }\r\n\r\n    const fetchShops = async () => {\r\n      try {\r\n        const data = await getShops();\r\n        setShops(data.data);\r\n      } catch (error) {\r\n        console.error(\"Failed to fetch shops:\", error);\r\n      }\r\n    };\r\n\r\n    fetchShops();\r\n  }, [router]);\r\n\r\n  const handleReservation = async () => {\r\n    const token = localStorage.getItem(\"token\");\r\n    if (!selectedShop || !selectedDate || !token) {\r\n      alert(\"Please select both a shop and a date.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const result = await createReservation({\r\n        massageShopId: selectedShop,\r\n        reserveDate: selectedDate.format(\"YYYY-MM-DD\"),\r\n        token,\r\n      });\r\n\r\n      alert(\"Reservation successful!\");\r\n      setSelectedShop(\"\");\r\n      setSelectedDate(null);\r\n      // router.push(\"/\"); // Uncomment if you want to redirect after success\r\n    } catch (err: any) {\r\n      console.error(\"Error making reservation:\", err);\r\n      alert(`Error: ${err.message}`);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex flex-col items-center justify-center min-h-screen bg-gray-100 p-6\">\r\n      <div className=\"bg-white shadow-lg rounded-lg p-8 w-full max-w-md\">\r\n        <div className=\"mb-4 w-full\">\r\n          <label className=\"block text-lg font-semibold mb-2 w-full\">\r\n            Date Reservation\r\n          </label>\r\n          <DateReserve selectedDate={selectedDate} setSelectedDate={setSelectedDate} />\r\n        </div>\r\n\r\n        <div className=\"mb-6\">\r\n          <label className=\"block text-lg font-semibold mb-2\">\r\n            Massage Shop\r\n          </label>\r\n          <select\r\n            className=\"w-full rounded-lg p-3 bg-gray-100 text-gray-700 hover:cursor-pointer\"\r\n            value={selectedShop}\r\n            onChange={(e) => setSelectedShop(e.target.value)}\r\n          >\r\n            <option value=\"\" disabled>Select Massage Shop</option>\r\n            {shops.map((shop) => (\r\n              <option key={shop._id} value={shop._id}>\r\n                {shop.name}\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </div>\r\n\r\n        <button\r\n          onClick={handleReservation}\r\n          className=\"hover:cursor-pointer w-full bg-red-600 text-white py-3 rounded-lg font-semibold text-lg hover:bg-red-500 transition\"\r\n        >\r\n          Make a reservation\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;;;AATA,cAAe,4CAA4C;;;;;;;;AAW3D,wIAAA,CAAA,UAAK,CAAC,MAAM,CAAC,yIAAA,CAAA,UAAG;AAED,SAAS;;IACtB,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAiB,EAAE;IACpD,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACjD,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAgB;IAC/D,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,eAAe,CAAA,GAAA,qIAAA,CAAA,kBAAe,AAAD;IAEnC,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;iCAAE;YACR,MAAM,SAAS,aAAa,GAAG,CAAC;YAChC,IAAI,QAAQ;gBACV,gBAAgB;YAClB;QACF;gCAAG;QAAC;KAAa,GAAI,mCAAmC;IAExD,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;iCAAE;YACR,MAAM,QAAQ,aAAa,OAAO,CAAC;YACnC,IAAI,CAAC,OAAO;gBACV,OAAO,IAAI,CAAC;gBACZ;YACF;YAEA,MAAM;oDAAa;oBACjB,IAAI;wBACF,MAAM,OAAO,MAAM,CAAA,GAAA,2HAAA,CAAA,UAAQ,AAAD;wBAC1B,SAAS,KAAK,IAAI;oBACpB,EAAE,OAAO,OAAO;wBACd,QAAQ,KAAK,CAAC,0BAA0B;oBAC1C;gBACF;;YAEA;QACF;gCAAG;QAAC;KAAO;IAEX,MAAM,oBAAoB;QACxB,MAAM,QAAQ,aAAa,OAAO,CAAC;QACnC,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,OAAO;YAC5C,MAAM;YACN;QACF;QAEA,IAAI;YACF,MAAM,SAAS,MAAM,CAAA,GAAA,oIAAA,CAAA,UAAiB,AAAD,EAAE;gBACrC,eAAe;gBACf,aAAa,aAAa,MAAM,CAAC;gBACjC;YACF;YAEA,MAAM;YACN,gBAAgB;YAChB,gBAAgB;QAChB,uEAAuE;QACzE,EAAE,OAAO,KAAU;YACjB,QAAQ,KAAK,CAAC,6BAA6B;YAC3C,MAAM,CAAC,OAAO,EAAE,IAAI,OAAO,EAAE;QAC/B;IACF;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAM,WAAU;sCAA0C;;;;;;sCAG3D,6LAAC,oIAAA,CAAA,UAAW;4BAAC,cAAc;4BAAc,iBAAiB;;;;;;;;;;;;8BAG5D,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAM,WAAU;sCAAmC;;;;;;sCAGpD,6LAAC;4BACC,WAAU;4BACV,OAAO;4BACP,UAAU,CAAC,IAAM,gBAAgB,EAAE,MAAM,CAAC,KAAK;;8CAE/C,6LAAC;oCAAO,OAAM;oCAAG,QAAQ;8CAAC;;;;;;gCACzB,MAAM,GAAG,CAAC,CAAC,qBACV,6LAAC;wCAAsB,OAAO,KAAK,GAAG;kDACnC,KAAK,IAAI;uCADC,KAAK,GAAG;;;;;;;;;;;;;;;;;8BAO3B,6LAAC;oBACC,SAAS;oBACT,WAAU;8BACX;;;;;;;;;;;;;;;;;AAMT;GA9FwB;;QAIP,qIAAA,CAAA,YAAS;QACH,qIAAA,CAAA,kBAAe;;;KALd","debugId":null}}]
}